webpackJsonp([1,9],{413:function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var a=n(25),o=i(a),r=n(780),s=i(r),l=n(24),c=(i(l),n(22)),d=i(c),u=n(21),p=i(u),m=n(29),f=n(2),g=i(f);e.default={components:{SelectDept:s.default},computed:(0,o.default)({},(0,m.mapGetters)(["getProj"])),data:function(){var t=this,e=function(e,n,i){return t.editForm.Compere?i():i(new Error("请选择主持人"))};return{Visible:!1,tableData:[],tabContent:[],activeTabName:"meeting",editLoading:!1,dept_Users_options:[],editForm:{MeetingCreatedAt:(0,g.default)().format("YYYY-MM-DD hh:mm:ss"),MeetingName:"",Compere:""},curCompere:[],editFormRules:{curCompere:[{type:"array",required:!0,validator:e,trigger:"change"}],MeetingName:[{required:!0,message:"请输入会议名称",trigger:"blur"}]},editFormVisible:!1,listLoading:!1,currentPageSize:0,handleSizeChange:0,currentPage:0,tableDataLength:0,curIndex4Meeting:0}},created:function(){this.getMeeting()},methods:{cancelEdit:function(){this.Visible=!1},submitEdit:function(t){this.Visible=!1,this.tabContent[this.curIndex4Meeting].Depts=t},submitContent:function(t){var e=this;if(!this.tabContent[t].Depts)return void e.$message({message:"请选择推送的部门!",type:"error"});var n={_id:this.tabContent[t]._id,MeetingID:this.editForm._id,MeetingTitle:this.tabContent[t].label,Content:this.tabContent[t].content,Depts:this.tabContent[t].Depts.map(function(t){return{DeptID:t.DeptID,DeptName:t.DeptName}})};p.default.post("/api/InsertOrUpdateMeetingContent",n).then(function(t){t.data.success?(e.$message({message:"提交成功",type:"success"}),e.getMeetingContent()):e.$message({message:"提交失败",type:"error"})}).catch(function(t){return console.log(t)})},Send2Person:function(t){this.Visible=!0,this.curIndex4Meeting=t;var e=this.tabContent[this.curIndex4Meeting].Depts;this.$refs.dept_select.UpdateSelected(e)},delcontent:function(t){var e=this;this.$confirm("是否删除该内容","系统提示",{type:"warning"}).then(function(){e.tabContent.splice(t,1)})},newContent:function(){this.tabContent.push({label:"会议内容",content:"",_id:-1})},changeActive:function(t){this.activeTabName==t.name&&(this.editForm.MeetingName="")},newMeeting:function(){this.editFormVisible=!0,this.editForm={MeetingName:"",MeetingCreatedAt:(0,g.default)().format("YYYY-MM-DD hh:mm:ss")},this.getDeptData()},editSubmit:function(){var t=this,e=this;e.$refs.editForm.validate(function(n){return n?void e.$confirm("确认提交吗？","提示",{}).then(function(){e.editLoading=!0,d.default.start(),p.default.post("/api/InsertOrUpdateMeeting",e.editForm).then(function(t){t.data.success?(e.$message({message:"提交成功",type:"success"}),e.getMeeting()):e.$message({message:"提交失败",type:"error"}),e.editFormVisible=!1,e.editLoading=!1,d.default.done()}).catch(function(t){e.editFormVisible=!1,e.editLoading=!1,d.default.done()}),e.editFormVisible=!1,e.editLoading=!1,d.default.done()}):void(t.editFormVisible=!1)})},handleEdit:function(t){this.editForm._id=t._id,this.editForm.MeetingName=t.MeetingName,this.editForm.MeetingCreatedAt=t.MeetingCreatedAt,this.editForm.Compere=t.Compere,this.activeTabName="content",this.getMeetingContent()},handleDel:function(t){},handleCurrentChange:function(){},handleItemChange:function(t){},refresh:function(){this.getMeeting()},getDeptData:function(){var t=this;({item2:t.getProj});p.default.get("/api/GetDeptByProjID?ProjID="+t.getProj).then(function(e){e.data.success&&(t.dept_Users_options=e.data.data,t.getMeeting())}).catch(function(t){return console.log(t)})},getMeeting:function(){var t=this;({item2:t.getProj});p.default.get("/api/GetMeetings?ProjID="+t.getProj).then(function(e){e.data.success&&(t.$data.tableData=e.data.data,t.$data.tableDataLength=e.data.meta.count)}).catch(function(t){return console.log(t)})},getMeetingContent:function(){var t=this;p.default.get("/api/GetMeetingContentByMeetingID?MeetingID="+t.editForm._id).then(function(e){e.data.success&&(t.tabContent=e.data.data.map(function(t){return{label:t.MeetingTitle,content:t.Content,Depts:t.Depts,_id:t._id}}))}).catch(function(t){return console.log(t)})}}}},419:function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var a=n(25),o=i(a),r=n(21),s=i(r),l=n(24),c=(i(l),n(22)),d=(i(c),n(29)),u=n(2);i(u);e.default={computed:(0,o.default)({},(0,d.mapGetters)(["getProj"])),props:["Visible"],data:function(){return{Depts:[]}},created:function(){this.getDepts()},methods:{cancelEdit:function(){this.$emit("cancelEdit"),this.Depts.forEach(function(t){t.Selected=!1})},submitEdit:function(){var t=this.Depts.filter(function(t){return t.Selected}).map(function(t){return{DeptID:t.value.id,DeptName:t.label}});this.$emit("submitEdit",t)},getDepts:function(t){var e=this;({item2:e.getProj});s.default.get("/api/GetDeptByProjID?ProjID="+e.getProj).then(function(n){n.data.success&&(e.Depts=n.data.data,t())}).catch(function(t){return console.log(t)})},UpdateSelected:function(t){var e=this;this.getDepts(function(){t&&e.Depts.forEach(function(e){t.filter(function(t){return t.DeptID==e.value.id}).length>0&&(e.Selected=!0)})})}}}},465:function(t,e,n){e=t.exports=n(31)(),e.push([t.id,'.text[data-v-00268902]{font-size:14px}.item[data-v-00268902]{margin-bottom:18px}.clearfix[data-v-00268902]:after,.clearfix[data-v-00268902]:before{display:table;content:""}.clearfix[data-v-00268902]:after{clear:both}.box-card[data-v-00268902]{width:98%;padding-top:5px;margin-top:5px}.el-tag[data-v-00268902]{margin-left:1px}',"",{version:3,sources:["/./public/src/components/business/Meeting.vue"],names:[],mappings:"AACA,uBACE,cAAgB,CACjB,AACD,uBACE,kBAAoB,CACrB,AACD,mEAEE,cAAe,AACf,UAAY,CACb,AACD,iCACE,UAAY,CACb,AACD,2BACE,UAAW,AACX,gBAAiB,AACjB,cAAgB,CACjB,AACD,yBACE,eAAiB,CAClB",file:"Meeting.vue",sourcesContent:['\n.text[data-v-00268902] {\r\n  font-size: 14px;\n}\n.item[data-v-00268902] {\r\n  margin-bottom: 18px;\n}\n.clearfix[data-v-00268902]:before,\r\n.clearfix[data-v-00268902]:after {\r\n  display: table;\r\n  content: "";\n}\n.clearfix[data-v-00268902]:after {\r\n  clear: both;\n}\n.box-card[data-v-00268902] {\r\n  width: 98%;\r\n  padding-top: 5px;\r\n  margin-top: 5px;\n}\n.el-tag[data-v-00268902] {\r\n  margin-left: 1px;\n}\r\n'],sourceRoot:"webpack://"}])},469:function(t,e,n){e=t.exports=n(31)(),e.push([t.id,".deptGroup[data-v-0b453818]{margin-top:2px}","",{version:3,sources:["/./public/src/components/businesscontrols/SelectDept.vue"],names:[],mappings:"AACA,4BACE,cAAgB,CACjB",file:"SelectDept.vue",sourcesContent:["\n.deptGroup[data-v-0b453818] {\r\n  margin-top: 2px;\n}\r\n"],sourceRoot:"webpack://"}])},750:function(t,e,n){var i=n(465);"string"==typeof i&&(i=[[t.id,i,""]]);n(33)(i,{});i.locals&&(t.exports=i.locals)},754:function(t,e,n){var i=n(469);"string"==typeof i&&(i=[[t.id,i,""]]);n(33)(i,{});i.locals&&(t.exports=i.locals)},774:function(t,e,n){n(750);var i=n(19)(n(413),n(783),"data-v-00268902",null);t.exports=i.exports},780:function(t,e,n){n(754);var i=n(19)(n(419),n(787),"data-v-0b453818",null);t.exports=i.exports},783:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-tabs",{staticStyle:{width:"100%"},on:{"tab-click":t.changeActive},model:{value:t.activeTabName,callback:function(e){t.activeTabName=e},expression:"activeTabName"}},[n("el-tab-pane",{attrs:{name:"meeting",label:"会议管理"}},[n("section",[n("el-col",{staticClass:"toolbar",attrs:{span:24}},[n("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0}},[n("el-form-item",[n("el-input",{attrs:{placeholder:"会议管理"}})],1),t._v(" "),n("el-form-item",[n("el-button",{on:{click:t.refresh}},[t._v("查询")]),t._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:t.newMeeting}},[t._v("新建会议")])],1)],1)],1),t._v(" "),n("el-col",{attrs:{span:24}},[[n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],staticStyle:{width:"100%",height:"100%"},attrs:{border:"",fit:"",stripe:"",data:t.tableData,"highlight-current-row":""}},[n("el-table-column",{attrs:{type:"index",label:"编号",width:"85"}}),t._v(" "),n("el-table-column",{attrs:{prop:"MeetingName",label:"会议名称"}}),t._v(" "),n("el-table-column",{attrs:{prop:"Compere",label:"主持人"}}),t._v(" "),n("el-table-column",{attrs:{prop:"MeetingCreatedAt",label:"会议时间"}}),t._v(" "),n("el-table-column",{attrs:{label:"操作",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-button",{attrs:{type:"text",size:"small"},on:{click:function(n){t.handleEdit(e.row)}}},[t._v("编辑")])]}}])})],1)],t._v(" "),n("el-col",{staticClass:"toolbar",staticStyle:{"padding-bottom":"10px"},attrs:{span:24}},[n("el-pagination",{staticStyle:{float:"right"},attrs:{"current-page":t.currentPage,"page-sizes":[10,20,30,40],"page-size":t.currentPageSize,layout:"total, sizes, prev, pager, next, jumper",total:t.tableDataLength},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1),t._v(" "),n("el-dialog",{attrs:{title:"新建会议","close-on-click-modal":!0},model:{value:t.editFormVisible,callback:function(e){t.editFormVisible=e},expression:"editFormVisible"}},[n("el-form",{ref:"editForm",attrs:{model:t.editForm,"label-width":"80px",rules:t.editFormRules}},[n("el-form-item",{attrs:{label:"会议名称",prop:"MeetingName"}},[n("el-input",{attrs:{disabled:t.editForm._id,"auto-complete":"off"},model:{value:t.editForm.MeetingName,callback:function(e){t.$set(t.editForm,"MeetingName",e)},expression:"editForm.MeetingName"}})],1),t._v(" "),n("el-form-item",{attrs:{label:"主持人",prop:"Compere"}},[n("el-input",{attrs:{disabled:t.editForm._id,"auto-complete":"off"},model:{value:t.editForm.Compere,callback:function(e){t.$set(t.editForm,"Compere",e)},expression:"editForm.Compere"}})],1),t._v(" "),n("el-form-item",{attrs:{label:"会议时间",prop:"MeetingCreatedAt"}},[n("el-date-picker",{staticStyle:{width:"100%"},attrs:{disabled:!0,placeholder:"选择日期时间",type:"datetime"},model:{value:t.editForm.MeetingCreatedAt,callback:function(e){t.$set(t.editForm,"MeetingCreatedAt",e)},expression:"editForm.MeetingCreatedAt"}})],1)],1),t._v(" "),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(e){t.editFormVisible=!1}}},[t._v("取 消")]),t._v(" "),n("el-button",{attrs:{type:"primary",loading:t.editLoading},on:{click:t.editSubmit}},[t._v("提交")])],1)],1)],2)],1)]),t._v(" "),t.editForm.MeetingName?n("el-tab-pane",{attrs:{name:"content",label:"内容管理"}},[n("section",[n("el-col",{staticClass:"toolbar",attrs:{span:24}},[n("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0}},[n("el-form-item",[n("el-input",{attrs:{placeholder:"内容管理"}})],1),t._v(" "),n("el-form-item",[n("el-button",{attrs:{type:"primary"},on:{click:t.newContent}},[t._v("新建内容")])],1)],1)],1),t._v(" "),t._l(t.tabContent,function(e,i){return n("div",{key:i},[n("el-card",{staticClass:"box-card"},[n("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[n("span",[n("el-input",{staticStyle:{float:"left",width:"30%"},model:{value:e.label,callback:function(n){t.$set(e,"label",n)},expression:"i.label"}})],1),t._v(" "),n("span",[t._v(t._s("-1"==e._id?"未上传":"已上传"))])]),t._v(" "),n("el-input",{attrs:{type:"textarea",placeholder:"输入内容"},model:{value:e.content,callback:function(n){t.$set(e,"content",n)},expression:"i.content"}}),t._v(" "),t._l(e.Depts,function(e,i){return n("el-tag",{key:i,attrs:{type:"success"}},[t._v(t._s(e.DeptName))])}),t._v(" "),n("el-button",{staticStyle:{float:"right"},attrs:{type:"info"},on:{click:function(e){t.submitContent(i)}}},[t._v("提交")]),t._v(" "),n("el-button",{staticStyle:{float:"right"},attrs:{type:"warning"},on:{click:function(e){t.Send2Person(i)}}},[t._v("推送部门")])],2)],1)}),t._v(" "),n("SelectDept",{ref:"dept_select",attrs:{Visible:t.Visible},on:{cancelEdit:t.cancelEdit,submitEdit:t.submitEdit}})],2)]):t._e()],1)},staticRenderFns:[]}},787:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-dialog",{attrs:{title:"选择部门","close-on-click-modal":!0},model:{value:t.Visible,callback:function(e){t.Visible=e},expression:"Visible"}},[n("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0}},t._l(t.Depts,function(e,i){return n("el-form-item",{key:i,attrs:{label:e.label}},[n("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949"},model:{value:e.Selected,callback:function(n){t.$set(e,"Selected",n)},expression:"i.Selected"}})],1)})),t._v(" "),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:t.cancelEdit}},[t._v("取 消")]),t._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:t.submitEdit}},[t._v("确定")])],1)],1)},staticRenderFns:[]}}});
//# sourceMappingURL=1.be2fa25ae5d4324fc991.js.map