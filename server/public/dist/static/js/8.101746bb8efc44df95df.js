webpackJsonp([8,9],{411:function(t,e,a){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var n=a(25),i=r(n),s=a(24),o=(r(s),a(22)),l=r(o),c=a(21),d=r(c),u=a(29);e.default={computed:(0,i.default)({},(0,u.mapGetters)(["getProj"])),data:function(){return{curCityID:-1,curProjID:-1,isEdit:!1,isEditText:"查看模式",default_active:"0",prov_city_options:[],proj_data:[],tableDeviceData:[],formInline:{user:""},listLoading:!1,currentPage:0,tableDataLength:0,currentPageSize:0,curentDeptID:-1}},created:function(){this.getProvData()},methods:{changeUserProj:function(t){var e=this;console.log(t._id);var a={UserID:t._id,ProjID:e.curProjID,insertOrDel:t.UserInProj?"insert":"del"};d.default.post("/api/InsertOrDelUserProj",a).then(function(a){a.data.success?e.$message({message:"["+t.UserName+"]设置成功",type:"success"}):console.log(a.data)}).catch(function(t){return console.log(t)})},handleselect:function(t){this.proj_data&&(this.curProjID=this.proj_data[t].value.id,this.getUserData())},handleItemChange:function(t){var e=this;this.curCityID=-1;var a=t[0],r=this,n="/api/GetCityByProvID?ProvID="+a.id;d.default.get(n).then(function(n){if(n.data.success){var i=r.prov_city_options.filter(function(t){return t.value.id==a.id})[0].children;n.data.data.map(function(t){return{label:t.Name,value:t.data}}).forEach(function(t){0==i.filter(function(e){return e.label==t.label}).length&&i.push(t)});var s=t[1];if(!s)return;e.curCityID=s.id,s?d.default.get("/api/GetProjByCityID?CityID="+s.id).then(function(t){t.data.success&&(r.proj_data=t.data.data,r.default_active="0",r.proj_data[0]?r.curProjID=r.proj_data[0].value.id:(r.isEdit=!1,r.isEditText="查看模式",e.curProjID=-1),r.getUserData())}).catch(function(t){console.log(t)}):(r.isEdit=!1,r.isEditText="查看模式",r.getUserData())}}).catch(function(t){console.log(t)})},formatSex:function(t,e){return 1==t.UserSex?"男":0==t.UserSex?"女":"未知"},handleEdit:function(t){},handleDel:function(t){},handleSizeChange:function(){},handleCurrentChange:function(){},changeEdit:function(){0==this.isEdit&&this.curCityID==-1?this.$message({message:"请先选择项目",type:"error"}):(this.isEdit=!this.isEdit,this.isEditText=this.isEdit?"编辑模式":"查看模式",this.getUserData())},getUserData:function(){var t=this,e="/api/GetUserByProjID",a={limit:t.$data.currentPageSize,page:t.$data.currentPage,ProjID:t.curProjID,isEdit:t.isEdit};t.listLoading=!0,l.default.start(),d.default.get(e,{params:a}).then(function(e){e.data.success?(t.$data.tableDeviceData=e.data.data,t.$data.tableDataLength=e.data.meta.count,t.listLoading=!1,l.default.done()):(t.$data.tableDeviceData=[],t.$data.tableDataLength=0,t.listLoading=!1,l.default.done())}).catch(function(t){return console.log(t)})},getProvData:function(){var t=this;d.default.get("/api/GetProv").then(function(e){e.data.success&&(t.prov_city_options=e.data.data)}).catch(function(t){return console.log(t)})}}}},471:function(t,e,a){e=t.exports=a(31)(),e.push([t.id,"","",{version:3,sources:[],names:[],mappings:"",file:"DeviceManager.vue",sourceRoot:"webpack://"}])},756:function(t,e,a){var r=a(471);"string"==typeof r&&(r=[[t.id,r,""]]);a(33)(r,{});r.locals&&(t.exports=r.locals)},772:function(t,e,a){a(756);var r=a(19)(a(411),a(789),"data-v-37cf4404",null);t.exports=r.exports},789:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-tabs",{staticStyle:{width:"100%"}},[a("el-tab-pane",{attrs:{label:"设备管理"}},[a("section",[a("el-col",{staticClass:"toolbar",attrs:{span:24}},[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:t.formInline}},[a("el-form-item",{attrs:{label:"区域选择"}},[a("el-cascader",{attrs:{options:t.prov_city_options,"change-on-select":""},on:{change:t.handleItemChange}})],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",round:""},on:{click:t.changeEdit}},[t._v(t._s(t.isEditText))])],1)],1)],1),t._v(" "),a("el-col",{attrs:{span:8}},[a("el-card",{staticClass:"box-card",attrs:{"body-style":{padding:"0px"}}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[t._v("项目列表")])]),t._v(" "),a("el-menu",{attrs:{"default-active":t.default_active},on:{select:t.handleselect}},t._l(t.proj_data,function(e,r){return a("el-menu-item",{key:r,attrs:{index:r+""}},[t._v(t._s(e.label))])}))],1)],1),t._v(" "),a("el-col",{attrs:{span:16}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],staticStyle:{width:"100%",height:"100%"},attrs:{border:"",fit:"",stripe:"",data:t.tableDeviceData,"highlight-current-row":""}},[a("el-table-column",{attrs:{type:"index",label:"编号",width:"85"}}),t._v(" "),a("el-table-column",{attrs:{prop:"UserID",label:"账号"}}),t._v(" "),a("el-table-column",{attrs:{prop:"UserName",label:"姓名"}}),t._v(" "),a("el-table-column",{attrs:{prop:"UserSex",label:"性别",formatter:t.formatSex}}),t._v(" "),a("el-table-column",{attrs:{prop:"UserAge",label:"年龄"}}),t._v(" "),a("el-table-column",{attrs:{prop:"UserPhoneNum",label:"手机号"}}),t._v(" "),t.isEdit?a("el-table-column",{attrs:{label:"成员",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-switch",{on:{change:function(a){t.changeUserProj(e.row)}},model:{value:e.row.UserInProj,callback:function(a){t.$set(e.row,"UserInProj",a)},expression:"scope.row.UserInProj"}})]}}])}):t._e()],1),t._v(" "),a("el-col",{staticClass:"toolbar",staticStyle:{"padding-bottom":"10px"},attrs:{span:24}},[a("el-pagination",{staticStyle:{float:"right"},attrs:{"current-page":t.currentPage,"page-sizes":[10,20,30,40],"page-size":t.currentPageSize,layout:"total, sizes, prev, pager, next, jumper",total:t.tableDataLength},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)],1)],1)])],1)],1)},staticRenderFns:[]}}});
//# sourceMappingURL=8.101746bb8efc44df95df.js.map