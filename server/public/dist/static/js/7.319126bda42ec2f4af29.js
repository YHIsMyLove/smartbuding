webpackJsonp([7,10],{350:function(e,t,a){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(6),s=r(n),l=a(10),i=(r(l),a(9)),o=r(i),c=a(5),d=r(c),u=a(7);t.default={data:function(){return{defaultKey:[0],formInline:{user:""},isEditText:"查看模式",isEdit:!1,expand:!1,filterText:"",treeDeptData:[],defaultProps:{children:"children",label:"label"},tableUserData:[],listLoading:!1,currentPage:0,tableDataLength:0,currentPageSize:0,curDeptID:-1}},created:function(){this.getDeptsData()},computed:(0,s.default)({},(0,u.mapGetters)(["getProj"])),methods:{changeUserDept:function(e){var t=this,a={UserID:e._id,ProjID:t.getProj.ProjID,DeptID:t.curDeptID,insertOrDel:e.UserInDept?"insert":"del"};d.default.post("/api/InsertOrDelUserDept",a).then(function(a){a.data.success?t.$message({message:"["+e.UserName+"]设置成功",type:"success"}):console.log(a.data)}).catch(function(e){return console.log(e)})},changeEdit:function(){this.isEdit=!this.isEdit,this.isEditText=this.isEdit?"编辑模式":"查看模式",this.getUserData()},selectDeptTreeChange:function(e){this.curDeptID=e.ID,this.getUserData()},filterNode:function(e,t){return!e||t.label.indexOf(e)!==-1},formatSex:function(e,t){return 1==e.UserSex?"男":0==e.UserSex?"女":"未知"},handleEdit:function(e){},handleDel:function(e){},handleSizeChange:function(){},handleCurrentChange:function(){},getDeptsData:function(){var e=this,t=this;return this.getProj?(t.listLoading=!0,o.default.start(),void d.default.get("/api/GetDeptTreeByProjID?ProjID="+t.getProj.ProjID).then(function(a){a.data.success?(t.treeDeptData=a.data.data,t.treeDeptData.length>0&&(t.defaultKey=[t.treeDeptData[0].ID]),e.getUserData()):e.$message({message:"请先选择项目",type:"error"}),t.listLoading=!1,o.default.done()}).catch(function(e){console.log(e),t.listLoading=!1,o.default.done()})):void this.$message({message:"请先选择项目",type:"error"})},getUserData:function(){var e=this,t="/api/GetUserByDeptID",a={limit:e.$data.currentPageSize,page:e.$data.currentPage,ProjID:e.getProj.ProjID,DeptID:e.curDeptID,isEdit:e.isEdit};e.listLoading=!0,o.default.start(),d.default.get(t,{params:a}).then(function(t){t.data.success?(e.$data.tableUserData=t.data.data,e.$data.tableDataLength=t.data.meta.count,e.listLoading=!1,o.default.done()):(e.$data.tableUserData=[],e.$data.tableDataLength=0,e.listLoading=!1,o.default.done())}).catch(function(e){return console.log(e)})}},watch:{filterText:function(e){this.$refs.deptTree.filter(e)}}}},414:function(e,t,a){t=e.exports=a(21)(),t.push([e.id,"","",{version:3,sources:[],names:[],mappings:"",file:"UserDeptManager.vue",sourceRoot:"webpack://"}])},505:function(e,t,a){var r=a(414);"string"==typeof r&&(r=[[e.id,r,""]]);a(22)(r,{});r.locals&&(e.exports=r.locals)},531:function(e,t,a){a(505);var r=a(3)(a(350),a(562),"data-v-48be00b8",null);e.exports=r.exports},562:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-tabs",{staticStyle:{width:"100%"}},[a("el-tab-pane",{attrs:{label:"用户部门管理"}},[a("section",[a("el-col",{staticClass:"toolbar",attrs:{span:24}},[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.formInline}},[a("el-form-item",[a("el-button",{attrs:{type:"primary",round:""},on:{click:e.changeEdit}},[e._v(e._s(e.isEditText))])],1)],1)],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-input",{attrs:{placeholder:"输入关键字进行过滤"},model:{value:e.filterText,callback:function(t){e.filterText=t},expression:"filterText"}}),e._v(" "),a("el-tree",{ref:"deptTree",staticClass:"filter-tree",attrs:{accordion:"","default-expand-all":"","expand-on-click-node":e.expand,"highlight-current":"",data:e.treeDeptData,props:e.defaultProps,"filter-node-method":e.filterNode,"default-checked-keys":e.defaultKey},on:{"current-change":e.selectDeptTreeChange}})],1),e._v(" "),a("el-col",{attrs:{span:16}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],staticStyle:{width:"100%",height:"100%"},attrs:{border:"",fit:"",stripe:"",data:e.tableUserData,"highlight-current-row":""}},[a("el-table-column",{attrs:{type:"index",label:"编号",width:"85"}}),e._v(" "),a("el-table-column",{attrs:{prop:"UserID",label:"账号"}}),e._v(" "),a("el-table-column",{attrs:{prop:"UserName",label:"姓名"}}),e._v(" "),a("el-table-column",{attrs:{prop:"UserSex",label:"性别",formatter:e.formatSex}}),e._v(" "),a("el-table-column",{attrs:{prop:"UserAge",label:"年龄"}}),e._v(" "),a("el-table-column",{attrs:{prop:"UserPhoneNum",label:"手机号"}}),e._v(" "),e.isEdit?a("el-table-column",{attrs:{label:"成员",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-switch",{on:{change:function(a){e.changeUserDept(t.row)}},model:{value:t.row.UserInDept,callback:function(a){e.$set(t.row,"UserInDept",a)},expression:"scope.row.UserInDept"}})]}}])}):e._e()],1),e._v(" "),a("el-col",{staticClass:"toolbar",staticStyle:{"padding-bottom":"10px"},attrs:{span:24}},[a("el-pagination",{staticStyle:{float:"right"},attrs:{"current-page":e.currentPage,"page-sizes":[10,20,30,40],"page-size":e.currentPageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.tableDataLength},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)],1)])],1)],1)},staticRenderFns:[]}}});
//# sourceMappingURL=7.319126bda42ec2f4af29.js.map