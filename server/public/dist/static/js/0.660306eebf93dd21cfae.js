webpackJsonp([0,10],{65:function(e,t,a){e.exports={default:a(67),__esModule:!0}},66:function(e,t,a){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var n=a(65),l=i(n);t.default=function(e,t,a){return t in e?(0,l.default)(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}},67:function(e,t,a){a(81);var i=a(26).Object;e.exports=function(e,t,a){return i.defineProperty(e,t,a)}},81:function(e,t,a){var i=a(34);i(i.S+i.F*!a(28),"Object",{defineProperty:a(30).f})},108:function(e,t,a){e.exports={default:a(376),__esModule:!0}},348:function(e,t,a){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(108),l=i(n),s=a(66),o=i(s),r=a(6),c=i(r),u=a(7),d=a(10),f=(i(d),a(9)),p=i(f),h=a(5),m=i(h),v=a(1),g=(i(v),a(530)),b=i(g);t.default={computed:(0,c.default)({},(0,u.mapGetters)(["getProj"])),data:function(){var e;return e={prov_city_options:[],activeCollapseNames:"1",activeName:"BusinessManager",formInline:{user:""},tableData:[],tableDataLength:0,listLoading:!1,currentPage:1,currentPageSize:10,options:[{value:"String",label:"字符类型"},{value:"Number",label:"数值类型"},{value:"Date",label:"日期类型"}],options_Fields:[{key:"none",value:"空"}],currentTabelName:"",EditLine:[{Title:"",Desc:"",Type:"String",Link:"空"}],BusinessTitle:"",BusinessTitleDesc:"",currentField:"",currentFieldNames:[]},(0,o.default)(e,"prov_city_options",[]),(0,o.default)(e,"proj_data",[]),(0,o.default)(e,"curProjID",""),e},created:function(){this.getSysFieldList(),this.getAllFieldList(),this.getProvData()},methods:{handleItemChange:function(e){var t=this;this.curCityID=-1;var a=e[0],i=this,n="/api/GetCityByProvID?ProvID="+a.id;m.default.get(n).then(function(n){if(n.data.success){var l=i.prov_city_options.filter(function(e){return e.value.id==a.id})[0].children;n.data.data.map(function(e){return{label:e.Name,value:e.data}}).forEach(function(e){0==l.filter(function(t){return t.label==e.label}).length&&l.push(e)});var s=e[1];if(!s)return;t.curCityID=s.id,s?m.default.get("/api/GetProjByCityID?CityID="+s.id).then(function(e){e.data.success&&(i.proj_data=e.data.data,i.default_active="0",i.proj_data[0]?i.curProjID=i.proj_data[0].value.id:t.curProjID=-1)}).catch(function(e){console.log(e)}):i.getUserData()}}).catch(function(e){console.log(e)})},getProvData:function(){var e=this;m.default.get("/api/GetProv").then(function(t){t.data.success&&(e.prov_city_options=t.data.data)}).catch(function(e){return console.log(e)})},handleDel:function(e){var t=this;this.$confirm("确认删除该记录吗?","提示",{type:"warning"}).then(function(){t.listLoading=!0,p.default.start(),m.default.post("/api/SysField/delete",{id:e._id}).then(function(e){e.data.success?(t.$message({message:"删除成功",type:"success"}),t.listLoading=!1,p.default.done(),t.getSysFieldList()):t.$message({message:"删除失败",type:"error"})})}).catch(function(){})},handleAdd:function(){this.activeName="BusinessInfo",this.BusinessTitle="",this.BusinessTitleDesc=""},getSysFieldList:function(){try{var e=this,t={limit:e.$data.currentPageSize,page:e.$data.currentPage};m.default.get("/api/SysField/",{params:t}).then(function(t){e.$data.tableData=t.data.data,e.$data.tableDataLength=t.data.meta.count}),m.default.get("/api/SysField/AllFieldName").then(function(t){e.$data.currentFieldNames=t.data.data})}catch(e){console.log(e)}},getAllFieldList:function(){try{m.default.get("/api/SysField/AllFieldName").then(function(e){var t=this;this.currentFieldNames=e.data.data,this.options_Fields=[{key:"none",value:"空"}],e.data.data.forEach(function(e){t.options_Fields.push({key:e.SysTabName,value:e.SysTabName})})}.bind(this))}catch(e){console.log(e)}},handleSizeChange:function(e){this.$data.currentPageSize=e,this.getSysFieldList()},handleCurrentChange:function(e){this.$data.currentPage=e,this.getSysFieldList()},handleEdit:function(e){var t=this;try{this.activeName="BusinessInfo",this.BusinessTitle=e.SysTabName,this.BusinessTitleDesc=e.SysTabDesc,this.currentField=e;var a=JSON.parse(e.SysFieldInfo);this.EditLine.splice(0,this.EditLine.length),(0,l.default)(a).forEach(function(e){t.EditLine.push({Title:e,Desc:a[e].desc,Type:a[e].type,Link:a[e].link})})}catch(e){console.log(e)}},onSubmit:function(){var e=this;if(""===this.BusinessTitle)return void this.$message({message:"请输入业务信息名称",type:"error"});if(this.EditLine.filter(function(e){return""===e.Title}).length>0)return void this.$message({message:"请输入业务信息标题",type:"error"});var t="{";this.EditLine.forEach(function(e){t+='"'+e.Title+'":{"type":"'+e.Type+'","desc":"'+e.Desc+'","link":"'+e.Link+'"},'}),t=t.substr(0,t.length-1)+"}",m.default.post("/api/SysField/create",{SysTabName:this.BusinessTitle,SysTabDesc:this.BusinessTitleDesc,SysFieldInfo:t}).then(function(t,a){return a?void e.$message({message:"保存失败："+a,type:"error"}):void e.$message({message:"保存成功",type:"success"})}),this.activeName="BusinessManager",this.getSysFieldList()},onAddLine:function(){this.EditLine.filter(function(e){return""===e.Title}).length>0?this.$message({message:"请输入业务信息标题",type:"error"}):this.EditLine.push({Title:"",Type:"String"})},onCancel:function(){this.activeName="BusinessManager",this.EditLine.splice(1,this.EditLine.length-1)},handleClick:function(){},onDelLine:function(e){1!==this.EditLine.length&&this.EditLine.splice(e,1)},newCustomTable:function(){try{this.activeName="BusinessInfo",this.activeCollapseNames="1",this.BusinessTitle="",this.BusinessTitleDesc="",this.EditLine=[{Title:"",Desc:"",Type:"String",Link:"空"}]}catch(e){console.log(e)}}},components:{SysFieldManager_Child:b.default}}},349:function(e,t,a){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(108),l=i(n),s=a(10),o=(i(s),a(9)),r=(i(o),a(5)),c=i(r),u=a(1);i(u);t.default={data:function(){return{EditLine:[{Title:"",Desc:"",Type:"String",Link:"",Value:"",ItemLinks:[]}],listLoading:!1,editFormVisible:!1,tableData:[],tableDataLength:0,list:[],loading:!1}},props:["Field","TabelName","TableDesc"],methods:{getFieldInfo:function(){var e=this;try{if(!this.Field)return;var t=JSON.parse(this.Field.SysFieldInfo);this.EditLine.splice(0,this.EditLine.length),(0,l.default)(t).forEach(function(a){var i={Title:a,Desc:t[a].desc,Type:t[a].type,Link:t[a].link};if(e.EditLine.push(i),"空"!==t[a].link)switch(t[a].link){case"用户表":break;default:c.default.get("/api/SysTable?SysFieldID="+t[a].link).then(function(e){i.ItemLinks=e.data.data,console.log(i)}.bind(i))}})}catch(e){console.log(e)}},getTabelData:function(){var e=this,t={limit:e.$data.currentPageSize,page:e.$data.currentPage,SysFieldID:e.TabelName};c.default.get("/api/SysTable/",{params:t}).then(function(t){e.$data.tableData=t.data.data,e.$data.tableDataLength=t.data.meta.count})},handleEdit:function(e){},handleDel:function(e){var t=this;this.$confirm("确认删除该记录吗?","提示",{type:"warning"}).then(function(){var a=t,i='{"_id":"'+e._id+'"}',n=JSON.parse(i);c.default.post("/api/SysTable/delete",n).then(function(e){console.log(e.data),e.data.success&&a.getTabelData()}).catch(function(e){return console.log(e)})})},newLine:function(){this.editFormVisible=!0},cancelNewline:function(){this.editFormVisible=!1},postNewline:function(){var e=this,t='{"SysFieldID":"'+this.TabelName+'",',a=0;this.EditLine.forEach(function(e){t+='"item'+a+'":"'+e.Value+'",',a++}),t=t.substr(0,t.length-1)+"}",console.log("保存"+t),c.default.post("/api/SysTable/create",JSON.parse(t)).then(function(t,a){return a?void e.$message({message:"保存失败："+a,type:"error"}):t.data.success?void e.$message({message:"保存成功",type:"success"}):void e.$message({message:"保存失败："+t.data.msg,type:"error"})}),this.editFormVisible=!1,this.getTabelData(),this.getFieldInfo()}},watch:{Field:function(e,t){this.getFieldInfo()},TabelName:function(e,t){this.getTabelData()}}}},376:function(e,t,a){a(400),e.exports=a(26).Object.keys},394:function(e,t,a){var i=a(34),n=a(26),l=a(35);e.exports=function(e,t){var a=(n.Object||{})[e]||Object[e],s={};s[e]=t(a),i(i.S+i.F*l(function(){a(1)}),"Object",s)}},400:function(e,t,a){var i=a(77),n=a(46);a(394)("keys",function(){return function(e){return n(i(e))}})},413:function(e,t,a){t=e.exports=a(21)(),t.push([e.id,'.toolbar .el-form-item[data-v-477f7607]{margin-bottom:10px}.toolbar[data-v-477f7607]{background:#fff;padding-top:10px}.text[data-v-477f7607]{font-size:14px}.item[data-v-477f7607]{margin-bottom:18px}.clearfix[data-v-477f7607]:after,.clearfix[data-v-477f7607]:before{display:table;content:""}.clearfix[data-v-477f7607]:after{clear:both}.box-card[data-v-477f7607]{width:480px}',"",{version:3,sources:["/./public/src/components/business/SysFieldManager.vue"],names:[],mappings:"AACA,wCAAwC,kBAAkB,CACzD,AACD,0BAA0B,gBAAgB,gBAAgB,CACzD,AACD,uBAAuB,cAAc,CACpC,AACD,uBAAuB,kBAAkB,CACxC,AACD,mEAAmE,cAAc,UAAU,CAC1F,AACD,iCAAiC,UAAU,CAC1C,AACD,2BAA2B,WAAW,CACrC",file:"SysFieldManager.vue",sourcesContent:['\n.toolbar .el-form-item[data-v-477f7607]{margin-bottom:10px\n}\n.toolbar[data-v-477f7607]{background:#fff;padding-top:10px\n}\n.text[data-v-477f7607]{font-size:14px\n}\n.item[data-v-477f7607]{margin-bottom:18px\n}\n.clearfix[data-v-477f7607]:before,.clearfix[data-v-477f7607]:after{display:table;content:""\n}\n.clearfix[data-v-477f7607]:after{clear:both\n}\n.box-card[data-v-477f7607]{width:480px\n}\n'],sourceRoot:"webpack://"}])},417:function(e,t,a){t=e.exports=a(21)(),t.push([e.id,"","",{version:3,sources:[],names:[],mappings:"",file:"SysFieldManager_Child.vue",sourceRoot:"webpack://"}])},504:function(e,t,a){var i=a(413);"string"==typeof i&&(i=[[e.id,i,""]]);a(22)(i,{});i.locals&&(e.exports=i.locals)},516:function(e,t,a){var i=a(417);"string"==typeof i&&(i=[[e.id,i,""]]);a(22)(i,{});i.locals&&(e.exports=i.locals)},529:function(e,t,a){a(504);var i=a(3)(a(348),a(560),"data-v-477f7607",null);e.exports=i.exports},530:function(e,t,a){a(516);var i=a(3)(a(349),a(576),"data-v-fd57ef78",null);e.exports=i.exports},560:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-tabs",{staticStyle:{width:"100%"},on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{name:"BusinessManager",label:"自定义表管理"}},[a("section",[a("el-col",{staticClass:"toolbar",attrs:{span:24}},[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.formInline}},[a("el-form-item",[a("el-input",{attrs:{placeholder:"表名"},model:{value:e.formInline.user,callback:function(t){e.$set(e.formInline,"user",t)},expression:"formInline.user"}})],1),e._v(" "),a("el-form-item",[a("el-button",{on:{click:e.getSysFieldList}},[e._v("查询")]),e._v(" "),a("el-button",{on:{click:e.newCustomTable}},[e._v("新增自定义表")])],1)],1)],1),e._v(" "),[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],staticStyle:{width:"100%",height:"100%"},attrs:{border:"",fit:"",stripe:"",data:e.tableData,"highlight-current-row":""}},[a("el-table-column",{attrs:{label:"编号",type:"index",width:"85"}}),e._v(" "),a("el-table-column",{attrs:{prop:"SysTabName",label:"表名"}}),e._v(" "),a("el-table-column",{attrs:{prop:"SysTabDesc",label:"描述"}}),e._v(" "),a("el-table-column",{attrs:{prop:"SysFieldInfo",label:"自定义字段"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){e.handleEdit(t.row)}}},[e._v("编辑")]),e._v(" "),a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){e.handleDel(t.row)}}},[e._v("删除")])]}}])})],1)],e._v(" "),a("el-col",{staticClass:"toolbar",staticStyle:{"padding-bottom":"10px"},attrs:{span:24}},[a("el-pagination",{staticStyle:{float:"right"},attrs:{"current-page":e.currentPage,"page-sizes":[10,20,30,40],"page-size":e.currentPageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.tableDataLength},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],2)]),e._v(" "),a("el-tab-pane",{attrs:{name:"BusinessInfo",label:"自定义字段管理"}},[a("el-collapse",{model:{value:e.activeCollapseNames,callback:function(t){e.activeCollapseNames=t},expression:"activeCollapseNames"}},[a("el-collapse-item",{attrs:{title:"表结构管理",name:"1"}},[a("el-form",{attrs:{"label-width":"80px"}},[a("el-form-item",{attrs:{label:"表名称"}},[a("el-input",{model:{value:e.BusinessTitle,callback:function(t){e.BusinessTitle=t},expression:"BusinessTitle"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"表描述"}},[a("el-input",{model:{value:e.BusinessTitleDesc,callback:function(t){e.BusinessTitleDesc=t},expression:"BusinessTitleDesc"}})],1),e._v(" "),e._l(e.EditLine,function(t,i){return a("el-form-item",{key:i,attrs:{label:"字段信息"}},[a("el-col",{attrs:{span:7}},[a("el-input",{attrs:{placeholder:"字段名称"},model:{value:t.Title,callback:function(a){e.$set(t,"Title",a)},expression:"item.Title"}})],1),e._v(" "),a("el-col",{attrs:{span:7}},[a("el-input",{attrs:{placeholder:"字段描述"},model:{value:t.Desc,callback:function(a){e.$set(t,"Desc",a)},expression:"item.Desc"}})],1),e._v(" "),a("el-col",{attrs:{span:4}},[a("el-select",{attrs:{placeholder:"关联字段"},model:{value:t.Link,callback:function(a){e.$set(t,"Link",a)},expression:"item.Link"}},e._l(e.options_Fields,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),a("el-col",{attrs:{span:4}},[a("el-select",{attrs:{placeholder:"字段类型"},model:{value:t.Type,callback:function(a){e.$set(t,"Type",a)},expression:"item.Type"}},e._l(e.options,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),a("el-col",{attrs:{span:2}},[a("el-button",{attrs:{type:"danger"},on:{click:function(t){e.onDelLine(i)}}},[e._v("删除")])],1)],1)}),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.onAddLine}},[e._v("新增行")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("提交")]),e._v(" "),a("el-button",{on:{click:e.onCancel}},[e._v("取消")])],1)],2)],1),e._v(" "),a("el-collapse-item",{attrs:{title:"表内容管理",name:"2"}},[a("SysFieldManager_Child",{attrs:{TabelName:e.BusinessTitle,TableDesc:e.BusinessTitleDesc,Field:e.currentField}})],1)],1)],1)],1)},staticRenderFns:[]}},576:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-col",{staticClass:"toolbar",attrs:{span:24}},[a("el-form",{staticClass:"demo-form-inline"},[a("el-button",{attrs:{type:"primary"},on:{click:e.newLine}},[e._v("新增行")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.getTabelData}},[e._v("刷新")])],1),e._v(" "),a("el-tabs",{staticStyle:{width:"100%"}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],staticStyle:{width:"100%",height:"100%"},attrs:{border:"",fit:"",stripe:"",data:e.tableData,"highlight-current-row":""}},[e._l(e.EditLine,function(e,t){return a("div",{key:t,staticStyle:{width:"100%",height:"100%"}},[a("el-table-column",{attrs:{prop:e.Title,label:e.Title}})],1)}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){e.handleDel(t.row)}}},[e._v("删除")])]}}])})],2)],1),e._v(" "),a("el-dialog",{attrs:{title:"新增行"},model:{value:e.editFormVisible,callback:function(t){e.editFormVisible=t},expression:"editFormVisible"}},[e._l(e.EditLine,function(t,i){return a("div",{key:i},[a("el-col",{attrs:{span:4}},[e._v("\n                "+e._s(t.Title)+"\n            ")]),e._v(" "),"空"==t.Link?a("el-col",{attrs:{span:20}},[a("el-input",{model:{value:t.Value,callback:function(a){e.$set(t,"Value",a)},expression:"item.Value"}})],1):a("el-col",{attrs:{span:20}},[a("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",placeholder:"请输入关键词",loading:e.loading},model:{value:t.Value,callback:function(a){e.$set(t,"Value",a)},expression:"item.Value"}},e._l(t.ItemLinks,function(t){return a("el-option",{key:t._id,attrs:{label:t._id,value:t._id}},e._l(Object.keys(t),function(i,n){return a("div",{key:n},["SysFieldID"!=i&&"_id"!=i&&n%2==0?a("span",{staticStyle:{float:"left"}},[e._v(e._s(t[i]))]):"SysFieldID"!=i&&"_id"!=i&&n%2!=0?a("span",{staticStyle:{float:"right",color:"#8492a6"}},[e._v(e._s(t[i])+"\n                                "),n!=Object.keys(t).length-1?a("span",[e._v("  |  ")]):e._e()]):e._e()])}))}))],1),e._v("\n             \n        ")],1)}),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.cancelNewline}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.postNewline}},[e._v("提交")])],1)],2)],1)},staticRenderFns:[]}}});
//# sourceMappingURL=0.660306eebf93dd21cfae.js.map