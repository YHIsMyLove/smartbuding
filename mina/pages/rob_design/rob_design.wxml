<!--pages/rob_design/rob_design.wxml-->
<view class='page'>
  <view class="weui-toptips weui-toptips_warn" wx:if="{{showTopTips}}">请更正表单错误</view>
  <view>
    <image></image>
    <view>还剩10个名额</view>
  </view>
  <view class='weui-grids'>
    <block wx:for='{{times}}' wx:key='*this'>
      <view class='weui-grid time-cell {{item.state == 0 ? "active" : ""}}' style='width:{{timeCellWidth}}'>
        <view>{{item.desc}}</view>
        <view class='time-state'>{{item.state == 0 ? "正在进行" : item.state == 1 ? "即将开始" : "抢单结束"}}</view>
      </view>
    </block>
  </view>
  <view class='time-remain'>
    剩余时间 00:00:00
  </view>
  <form bindsubmit="rob">
    <input name='houseImageUrl' hidden value='{{houseImagePath}}' />
    <input name='region' hidden value='{{region[0]}}，{{region[1]}}，{{region[2]}}' />
    <input name='house' hidden value='{{houses[houseIndex]}}' />
    <input name='houseStyle' hidden value='{{houseStyles[houseStyleIndex]}}' />
    <view class="weui-cells weui-cells_after-title">
      <view class="weui-cell weui-cell_input">
        <view class="weui-cell__hd">
          <view class="weui-label">户型图</view>
        </view>
        <view class="weui-cell__bd">
          <view class='weui-flex houseImageContainer'>
            <view class='weui-flex__item'>
              <view class="weui-uploader__file {{isOnsiteService ? 'weui-uploader__file_status' : ''}}" bindtap="previewImage" id="{{houseImagePath}}">
                <image class="weui-uploader__img" src="{{houseImagePath}}" mode="aspectFill" />
                <view class='weui-uploader__file-content' wx:if='{{isOnsiteService}}'>
                  <icon type="cancel" size="23"></icon>
                </view>
                <!-- <view class="weui-uploader__file-content">50%</view> -->
              </view>
            </view>
            <view class='weui-flex__item'>
              <view class='weui-vcode-btn' bindtap='chooseImage'>本地上传</view>
              <view class='weui-vcode-btn'>
                <navigator url='../select-house-image/select-house-image'>从服务器选择</navigator>
              </view>
              <view class='weui-vcode-btn'>
                <label bindtap='changeOnsiteService'>
                  <checkbox checked='{{isOnsiteService}}'></checkbox>上门量房</label>
              </view>
            </view>
          </view>
        </view>
      </view>
      <view class='weui-cell weui-cell_input {{validation.region.valid ? "" : "weui-cell_warn"}}'>
        <view class='weui-cell__hd'>
          <view class='weui-label'>所在地区</view>
        </view>
        <view class='weui-cell__bd'>
          <picker mode="region" bindchange="regionChange" value="{{region}}">
            <view class="weui-input">
              {{region[0]}}，{{region[1]}}，{{region[2]}}
            </view>
          </picker>
        </view>
        <view class="weui-cell__ft" wx:if='{{!validation.region.valid}}'>
          <icon type="warn" size="23" color="#E64340"></icon>
        </view>
      </view>
      <view class="weui-cell weui-cell_input {{validation.house.valid ? '' : 'weui-cell_warn'}}">
        <view class="weui-cell__hd">
          <view class="weui-label">所在小区</view>
        </view>
        <view class="weui-cell__bd">
          <picker value="{{houseIndex}}" bindchange="houseChanged" range="{{houses}}">
            <view class="weui-input">{{houses[houseIndex]}}</view>
          </picker>
        </view>
        <view class="weui-cell__ft" wx:if='{{!validation.house.valid}}'>
          <icon type="warn" size="23" color="#E64340"></icon>
        </view>
      </view>

      <view class="weui-cell weui-cell_input {{validation.name.valid ? '' : 'weui-cell_warn'}}">
        <view class="weui-cell__hd">
          <view class="weui-label">姓名</view>
        </view>
        <view class="weui-cell__bd">
          <input name='name' class="weui-input" placeholder="请输入您的姓名" />
        </view>
        <view class="weui-cell__ft" wx:if='{{!validation.name.valid}}'>
          <icon type="warn" size="23" color="#E64340"></icon>
        </view>
      </view>
      <view class="weui-cell weui-cell_input weui-cell_vcode">
        <view class="weui-cell__hd">
          <view class="weui-label">手机号</view>
        </view>
        <view class="weui-cell__bd">
          <input name='mobile' class="weui-input" type='number' placeholder="请输入手机号" />
        </view>
        <view class="weui-cell__ft">
          <view class='vcode'>
            <view class='vcode-btn' wx:if='{{canGetVCode}}' bindtap='getVCode'>获取验证码</view>
            <view wx:if='{{!canGetVCode}}'>{{canGetVCodeRemainTime}}秒</view>
          </view>
        </view>
      </view>
      <view class="weui-cell weui-cell_input {{validation.vcode.valid ? '' : 'weui-cell_warn'}}">
        <view class="weui-cell__hd">
          <view class="weui-label">验证码</view>
        </view>
        <view class="weui-cell__bd">
          <input name='vcode' class="weui-input" type='number' placeholder="请输入短信验证码" />
        </view>
        <view class="weui-cell__ft" wx:if='{{!validation.vcode.valid}}'>
          <icon type="warn" size="23" color="#E64340"></icon>
        </view>
      </view>
      <view class="weui-cell weui-cell_input {{validation.houseStyle.valid ? '' : 'weui-cell_warn'}}">
        <view class="weui-cell__hd">
          <view class="weui-label">风格</view>
        </view>
        <view class="weui-cell__bd">
          <picker value="{{styleIndex}}" bindchange="styleChanged" range="{{houseStyles}}">
            <view class="weui-input">{{houseStyles[houseStyleIndex]}}</view>
          </picker>
        </view>
        <view class="weui-cell__ft" wx:if='{{!validation.houseStyle.valid}}'>
          <icon type="warn" size="23" color="#E64340"></icon>
        </view>
      </view>
      <view class="weui-cell weui-cell_input {{validation.houseArea.valid ? '' : 'weui-cell_warn'}}">
        <view class="weui-cell__hd">
          <view class="weui-label">面积</view>
        </view>
        <view class="weui-cell__bd">
          <input name='houseArea' type='number' class="weui-input" placeholder="" value='100' />
        </view>
        <view class="weui-cell__ft" wx:if='{{!validation.houseArea.valid}}'>
          <icon type="warn" size="23" color="#E64340"></icon>
        </view>
      </view>
    </view>
    <view class="weui-btn-area">
      <button class="weui-btn" type="primary" form-type='submit'>抢单</button>
    </view>
  </form>
</view>